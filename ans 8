import pandas as pd
from sklearn.feature_extraction.text import CountVectorizer
from sklearn.naive_bayes import MultinomialNB

# Load the training data
train_data = pd.read_csv('/content/Email_Dataset.csv')
# Load the test data
test_data = pd.read_csv('/content/Email Test Data.csv')

# Extract features and labels from the training data
X_train = train_data['MESSAGE']
y_train = train_data['CATEGORY']
# Extract features from the test data
X_test = test_data['MESSAGE']

# Convert text data to feature vectors
vectorizer = CountVectorizer()
X_train_vec = vectorizer.fit_transform(X_train)
X_test_vec = vectorizer.transform(X_test)

# Initialize the Naive Bayes classifier
nb_classifier = MultinomialNB()

# Train the classifier
nb_classifier.fit(X_train_vec, y_train)

# Make predictions on the test data
test_predictions = nb_classifier.predict(X_test_vec)

# Add the predictions to the test data
test_data['predicted_label'] = test_predictions

# Save the results to a new CSV file
test_data.to_csv('classified_test.csv', index=False)

print("Classification completed. Results saved to 'classified_test.csv'.")
